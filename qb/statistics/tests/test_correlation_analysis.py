from qb.statistics.correlation_analysis import partial3var, auto_correlation
from numpy.testing import assert_equal


def test_partial3var():
    a = [
        270.3, 298.4, 297.2, 274.4, 189.1, 137.4, 126.4, 120.2, 143.9, 103.4,
        327.5, 686.4, 786.4, 825.9, 1011.5, 1004.2, 926.4, 845.1, 766.1, 720.0,
        644.8, 622.4, 606.7, 569.4
    ]
    b = [
        6.3, 5.8, 5.3, 4.7, 4.2, 3.7, 3.3, 2.7, 5.3, 8.5,
        11.3, 11.8, 11.1, 10.3, 9.9, 9.7, 8.8, 7.6, 6.3, 4.8,
        3.6, 2.7, 2.1, 1.6
    ]
    c = [
        4.8, 5.2, 5.1, 4.8, 4.7, 4.6, 4.7, 4.7, 4.6, 3.4,
        2.9, 5.1, 7.3, 8.7, 9.1, 10.0, 10.8, 11.1, 10.8, 9.7,
        8.1, 7.3, 6.8, 6.4
    ]

    stat, pvalue = partial3var(a, b, c)

    assert_equal(pvalue <= 0.05, True)
